(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))m(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&m(h)}).observe(document,{childList:!0,subtree:!0});function a(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function m(t){if(t.ep)return;t.ep=!0;const i=a(t);fetch(t.href,i)}})();const T="./camera_para.dat",H="./pattern-marker.patt";var c=[],e,p,o,l=new THREE.WebGLRenderer({alpha:!0});l.setClearColor(new THREE.Color("lightgrey"),0);l.setSize(window.innerWidth,window.innerHeight);l.domElement.style.position="absolute";l.domElement.style.top="0px";l.domElement.style.left="0px";document.body.appendChild(l.domElement);var s=new THREE.Scene,E=new THREE.Camera;s.add(E);p=new THREE.Group;s.add(p);o=new THREEx.ArToolkitSource({sourceType:"webcam"});o.init(()=>{o.domElement.addEventListener("canplay",()=>{console.log("canplay","actual source dimensions",o.domElement.videoWidth,o.domElement.videoHeight),C(),g()}),window.arToolkitSource=o});function C(){console.log("initARContext()"),e=new THREEx.ArToolkitContext({cameraParametersUrl:T,detectionMode:"mono",maxDetectionRate:30,canvasWidth:80*3,canvasHeight:60*3}),e.init(function(){E.projectionMatrix.copy(e.getProjectionMatrix()),e.arController.orientation=R(),e.arController.options.orientation=R(),console.log("arToolkitContext",e),window.arToolkitContext=e}),new THREEx.ArMarkerControls(e,p,{type:"pattern",patternUrl:H})}function R(){return o?(console.log("actual source dimensions",o.domElement.videoWidth,o.domElement.videoHeight),o.domElement.videoWidth>o.domElement.videoHeight?(console.log("source orientation","landscape"),"landscape"):(console.log("source orientation","portrait"),"portrait")):null}function x(){var r;console.log("disposeARSource()");const n=document.querySelector("#arjs-video");n&&((r=n==null?void 0:n.srcObject)==null||r.getTracks().map(a=>a.stop()),n.remove()),o=null}function S(){var n,r,a;console.log("disposeARContext()"),(r=(n=e==null?void 0:e.arController)==null?void 0:n.cameraParam)!=null&&r.dispose&&e.arController.cameraParam.dispose(),(a=e==null?void 0:e.arController)!=null&&a.dispose&&e.arController.dispose(),e=null}window.addEventListener("resize",function(){g()});function g(){o.onResizeElement(),o.copyElementSizeTo(l.domElement),e.arController!==null&&o.copyElementSizeTo(e.arController.canvas)}window.close=function(){S(),x()};c.push(function(){!e||!o||!o.ready||(e.update(o.domElement),s.visible=E.visible)});s.visible=!1;var v=new THREE.Group;s.add(v);var A=new THREEx.ArSmoothedControls(v,{lerpPosition:.4,lerpQuaternion:.3,lerpScale:1});c.push(function(n){A.update(p)});var w=v,f=new THREE.BoxGeometry(1,1,1),y=new THREE.MeshNormalMaterial({transparent:!0,opacity:.5,side:THREE.DoubleSide}),d=new THREE.Mesh(f,y);d.position.y=f.parameters.height/2;w.add(d);var f=new THREE.TorusKnotGeometry(.3,.1,64,16),y=new THREE.MeshNormalMaterial,d=new THREE.Mesh(f,y);d.position.y=.5;w.add(d);c.push(function(){d.rotation.x+=.1});c.push(function(){l.render(s,E)});var u=null;requestAnimationFrame(function n(r){requestAnimationFrame(n),u=u||r-1e3/60;var a=Math.min(200,r-u);u=r,c.forEach(function(m){m(a/1e3,r/1e3)})});
